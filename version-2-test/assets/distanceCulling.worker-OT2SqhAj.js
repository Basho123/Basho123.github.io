(function(){"use strict";self.onmessage=w=>{const d=w.data;if(d.type==="distance"){const{matrices:t,camPos:n,maxDistSq:i}=d,u=n[0],h=n[1],b=n[2],p=t.length/16,o=new Uint32Array(p);let e=0;for(let c=0;c<p;c++){const r=c*16,x=t[r+12],m=t[r+13],a=t[r+14],s=x-u,l=m-h,f=a-b;s*s+l*l+f*f<i&&(o[e++]=c)}self.postMessage(o.subarray(0,e),[o.buffer]);return}if(d.type==="frustum"){const{matrices:t,planes:n,sphereCenterLocal:i,sphereRadius:u,meshHideOffsetY:h,boundsPadding:b,planePadding:p}=d,o=t.length/16,e=new Uint32Array(o);let c=0;const r=i[0],x=i[1],m=i[2];for(let a=0;a<o;a++){const s=a*16,l=Math.hypot(t[s+0],t[s+1],t[s+2]),f=Math.hypot(t[s+4],t[s+5],t[s+6]),z=Math.hypot(t[s+8],t[s+9],t[s+10]),L=t[s+12]+r*l,P=t[s+13]+x*f-h,v=t[s+14]+m*z,A=Math.max(l,f,z),S=u*A+b;let M=!0;for(let g=0;g<6;g++){const y=g*4,U=n[y+0],k=n[y+1],q=n[y+2],C=n[y+3];if(U*L+k*P+q*v+C<-S-p){M=!1;break}}M&&(e[c++]=a)}self.postMessage(e.subarray(0,c),[e.buffer])}}})();
